<!DOCTYPE html>
<html lang="en" xmlns:c="http://www.w3.org/1999/XSL/Transform" xmlns:th="http://www.w3.org/1999/xhtml" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="layout/common :: head('Instargram')"></head>
<body>
<nav th:fragment="menu(menu)">
    <div class="nav-container">
        <div class="nav-1">
            <img class="logo_instagram" src="/img/logo_text.png" alt="logo_text">
        </div>
        <input id="searchInput" type="search" class="input-search" placeholder="검색">
        <div class="nav-2">
            <a href="/user/story"><img src="/img/home.png" alt="홈"></a>
            <img src="/img/dm.png" alt="DM">
            <img src="https://s3.ap-northeast-2.amazonaws.com/cdn.wecode.co.kr/bearu/explore.png" alt="탐색">
            <img src="https://s3.ap-northeast-2.amazonaws.com/cdn.wecode.co.kr/bearu/heart.png" alt="하트">
            <a th:href="@{/user/profile(id=${userProfileDto.loginId})}" ><img class="pic" th:src="@{${'/profile_imgs/' + userProfileDto.userDto.profileImgUrl}}" onerror="this.src='/img/default_profile.jpg';"></a>
        </div>
    </div>
</nav>
<!--프로필 섹션-->
<main class="profile_main">
<section class="profile">
    <!--유저정보 컨테이너-->
    <div class="profileContainer">
        <!--유저이미지-->
        <div class="profile-left">
            <div class="profile-img-wrap story-border">
                <form id="userProfileImageForm">
                    <input type="file" name="profileImageFile" style="display: none;" id="userProfileImageInput" />
                </form>
                <img class="profile-image" th:src="@{${'/profile_imgs/' + userProfileDto.userDto.profileImgUrl}}" onerror="this.src='/img/default_profile.jpg';"/>
            </div>
        </div>
        <!--유저이미지end-->
        <!--유저정보 및 사진등록 구독하기-->
        <div class="profile-right">
            <div class="name-group" >
                <h2 th:text="${userProfileDto.userDto.name}" ></h2>
                <button class="cta" th:if="${userProfileDto.loginUser}">사진등록</button>
                <span></span>
                <button class="cta" th:if="!${userProfileDto.loginUser} and !${userProfileDto.follow}" th:onclick="|toggleSubscribe(${userProfileDto.userDto.id}, this)|">팔로우</button>
                <button class="cta" th:if="!${userProfileDto.loginUser} and ${userProfileDto.follow}" th:onclick="|toggleSubscribe(${userProfileDto.userDto.id}, this)|">언팔로우</button>
                <button class="modi" th:if="${userProfileDto.loginUser}" onclick="popup('.modal-info')">
                    <i class="fas fa-cog"></i>
                </button>
            </div>

            <div class="subscribe">
                <ul>
                    <li>게시물<span>0</span></li>
                    <li><a class="follow" th:onclick="|followerInfoModalOpen(${userProfileDto.userDto.id})|" style="text-decoration:none">팔로워 </a><span th:text="${userProfileDto.userFollowerCount}" ></span>
                    <li><a class="follow" th:onclick="|followingInfoModalOpen(${userProfileDto.userDto.id})|" style="text-decoration:none">팔로잉 </a><span th:text="${userProfileDto.userFollowingCount}" ></span>
                </ul>
            </div>
            <div class="state">
                <h4 th:text="${userProfileDto.userDto.title}"></h4>
                <h4 th:text="${userProfileDto.userDto.website}"></h4>
            </div>
        </div>
        <!--유저정보 및 사진등록 구독하기 end-->
    </div>
</section>
<!--게시물컨섹션-->
<section id="tab-content">
    <!--게시물컨컨테이너-->
    <div class="profileContainer">
        <!--그냥 감싸는 div (지우면이미지커짐)-->
        <div id="tab-1-content" class="tab-content-item show">
            <!--게시물컨 그리드배열-->
            <div class="tab-1-content-inner">
                <!--아이템들-->
                <c:forEach var="image" items="${dto.userDto.images}"> <!-- EL표현식에서 변수명을 적으면 get함수가 자동 호출된다. -->
                    <div class="img-box">
                        <a href=""> <img src="/img/sample.jpg" />
                        </a>
                        <div class="comment">
                            <a href="#" class=""> <i class="fas fa-heart"></i><span>${image.likeCount}</span>
                            </a>
                        </div>
                    </div>
                </c:forEach>
                <c:forEach var="image" items="${dto.userDto.images}"> <!-- EL표현식에서 변수명을 적으면 get함수가 자동 호출된다. -->
                    <div class="img-box">
                        <a href=""> <img src="/img/sample.jpg" />
                        </a>
                        <div class="comment">
                            <a href="#" class=""> <i class="fas fa-heart"></i><span>${image.likeCount}</span>
                            </a>
                        </div>
                    </div>
                </c:forEach>
                <!--아이템들end-->
            </div>
        </div>
    </div>
</section>

<!--로그아웃, 회원정보변경 모달-->
<div class="modal-info" >
    <div class="modal">
        <button onclick="location.href='/user/update'">회원정보 변경</button>
        <button onclick="location.href='/logout'">로그아웃</button>
        <button onclick="closePopup('.modal-info')">취소</button>
    </div>
</div>
<!--로그아웃, 회원정보변경 모달 end-->

<!--프로필사진 바꾸기 모달-->
<div class="modal-image" >
    <div class="modal">
        <p>프로필 사진 바꾸기</p>
        <button >사진 업로드</button>
        <button >취소</button>
    </div>
</div>
<!--프로필사진 바꾸기 모달end-->
<div class="modal-follower">
    <div class="subscribe">
        <div class="subscribe-header">
            <span>팔로워</span>
            <button class="exit" onclick="modalClose()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="subscribe-list" id="followerModalList">
        </div>
    </div>
</div>
    <div class="modal-following">
        <div class="subscribe">
            <div class="subscribe-header">
                <span>팔로잉</span>
                <button class="exit" onclick="modalClose()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="subscribe-list" id="followingModalList">
            </div>
        </div>
    </div>
<footer th:replace="layout/common :: footer('footer')"></footer>
</main>
<script src="/js/profile.js">
</script>
</body>
</html>